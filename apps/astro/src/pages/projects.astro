---
import GitHubProjectsGrid from "~/components/projects/GitHubProjectsGrid.astro";
import ProjectsOverviewGrid from "~/components/projects/ProjectsOverviewGrid.astro";
import Layout from "~/layouts/Root.astro";
import { getRepos } from "~/lib/projects.server";
import { status } from "~/lib/utils";
import { ANIMATE_COLORS_CLASSES } from "~/consts";
const repos = await getRepos(Astro.request);

// nothing to show :( redirect
if (repos.every((r) => r.status === 400)) {
  return redirect(`/?status=${status.octokit}`);
}

const personal = repos[0];
const work = repos[1];
---

<Layout title="BN | Projects" description="A selection of my GitHub projects">
  <div class="flex flex-col gap-8 py-8">
    <section>
      <h1
        class=`${ANIMATE_COLORS_CLASSES} bg-radial from-white to-transparent px-8 text-center text-4xl font-bold border-b-8 border-white`
      >
        Projects
      </h1>
      <ProjectsOverviewGrid />
    </section>
    <section>
      <h2
        class="bg-radial mt-4 border-b-8 border-white from-white to-transparent px-8 text-center text-4xl font-bold"
      >
        GitHub <span class=`${ANIMATE_COLORS_CLASSES}`>Personal</span> Projects
      </h2>
      <GitHubProjectsGrid data={personal.data} />
    </section>
    <section>
      <div
        class="bg-radial mt-4 flex flex-col gap-2 border-b-8 border-white from-white to-transparent px-8 text-center"
      >
        <h2 class="text-4xl font-bold">
          GitHub <span class=`${ANIMATE_COLORS_CLASSES}`>Work</span> Projects
        </h2>
        <p>
          The following are typically CI items, POC, etc. and are aren't suited
          for production
        </p>
      </div>
      <GitHubProjectsGrid data={work.data} />
    </section>
  </div>
</Layout>
